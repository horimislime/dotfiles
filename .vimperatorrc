"=======================================
"General settings
"=======================================

"Always autocomplete
set wildoptions=auto
set wildmode=list:full

"Hide scrollbar
:set go-=rb

"Ignore upper/lower case
set ignorecase

"Disable beep sound
set visualbell

"Avoid focusing on text box
"set focuscontent

"Set browser title
set titlestring=Firefox

set hlsearch
set preload
highlight Bell display:none

"=======================================
"Keybind settings
"=======================================

"Set amount of scroll by j/k to 3line
map j 1<C-e>
map k 1<C-y>

"Asign backward action to Backspace key
map <BS> <A-Left>

"Move to a left/right tab using h/l
map K gT
map J gt

"Move the active tab to left/right using <S-Left>/<S-Right>
map <S-Left> :tabmove! -1<CR>
map <S-Right> :tabmove! +1<CR>

"Move to the previously selected tab
"map p :buffer! #<CR>

"Move to the last tab
map L g$

"Open Print window
map P :hardcopy<CR>

"status bar panel mapping
map s :statusbarpanel

"Show Evernote clipping button on status bar
map E :statusbarpanel webclipper3-button-clone<CR>

"Hatena bookmark setting
javascript if (typeof hBookmark != 'undefined') liberator.loadScript('chrome://hatenabookmark/content/vimperator/plugin/hatenabookmark.js', {__proto__: this});

"Send to Instapaper(requires Instapaper.js)
map I :rl<CR>

"Bindings on Slideshare(requires slideshare.js)
nnoremap -urls=www\\.slideshare\\.net l :slideshare next<CR>
nnoremap -urls=www\\.slideshare\\.net h :slideshare prev<CR>


"=======================================
"Command declarations
"=======================================

"Reload .vimeratorrc
command reload_rc :source ~/.vimperatorrc

"Evernote clipping command
command clip javascript Evernote.Overlay.init(null)


"=======================================
"Plugin configurations
"=======================================

"_smooziee.js
let g:smooziee_scroll_amount="500"
let g:smooziee_scroll_interval="50"

"ldrize_cooperation.js
let g:ldrc_intelligence_bind="true"

"switchtab.js
map T :switchTab<CR>

"FeedSomeKeys_3.js
command! -nargs=+ lazy autocmd VimperatorEnter .* <args>
lazy fmaps -u='mail\.google\.com/mail' c / j k n p o u e x s r a # [ ] ? gi gs gt gd ga gc
lazy fmaps -u='mail\.google\.com/mail/.*/[0-9a-f]+$' c / j,n k,p n,j p,k o u e x s r a # [ ] ? gi gs gt gd ga gc
lazy fmaps -u='www\.google\.com/reader' -events=vkeypress j k i o n p m s v A r S N P X O gh ga gs gt gu u / ?
lazy fmaps -u='(fastladder|livedoor)\.com/reader' j k s a p o v c i,p <Space> <S-Space> z b < > q w e,g
lazy fmaps -u='https?://www\.rememberthemilk\.com/home/' j k m i c t ? d F,f G,g S,s L,l Y,y H,h M,m <Del> <C-S-Left> <C-S-Right>
lazy fmaps -u='http://code.google.com/p/vimperator-labs/issues/list' o j k
lazy fmaps -u='http://code.google.com/p/vimperator-labs/issues/detail' u
lazy fmaps -u='www\.facebook\.com/' j k
lazy fmaps -u='reblog\.machine\.mamemomonga\.com/*' t l j k m

"pdf.js
nnoremap -urls "^chrome:\\/\\/pdf\\.js\\/content\\/web\\/viewer.html\\?file=.*" <C-j> :js content.window.PDFView.page++<CR>
nnoremap -urls "^chrome:\\/\\/pdf\\.js\\/content\\/web\\/viewer.html\\?file=.*" <C-k> :js content.window


"twittperator.js
js <<EOM
commands.addUserCommand(
    ["twurl"],
    "Twittperator tweet with URI",
    function(){
        let uri = 'https://www.googleapis.com/urlshortener/v1/url';
        let xhr = new XMLHttpRequest();
        xhr.open("POST", uri, false);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.send(JSON.stringify({ longUrl: buffer.URI }));
        let result = JSON.parse(xhr.responseText).id;
        commandline.open(":",["tw"," /",buffer.title,result].join(" "),modes.EX);
    }
);
EOM

"pdf.js
var viewerReg = /^chrome:\/\/pdf\.js\/content\/web\/viewer.html\?file=.*/;

var maps = [
  Map([modes.NORMAL], ["<C-j>"], "pdf.js go next page",
    function (count) {
      content.window.PDFView.page += Math.max(count, 1);
    }, {
      count: true,
      matchingUrls: viewerReg,
    }
  ),
  Map([modes.NORMAL], ["<C-k>"], "pdf.js go previous page",
    function (count) {
      content.window.PDFView.page -= Math.max(count, 1);
    }, {
      count: true,
      matchingUrls: viewerReg,
    }
  )];
maps.forEach(function (map) {
  mappings._addMap(map);
});

"=======================================
"Appearances
"=======================================

"Stylesheet setting
colorscheme snaka_custom

"Move menubar items on statusbar
set statuslinetoolbars=webclipper3-button,feed-button

"Restrict characters for Hint
set hintchars=ifjklasdweuocvbnm